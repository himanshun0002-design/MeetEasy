<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Meeteasy Room</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f4f4f9;
      color: #333;
    }
    h2 {
      margin-top: 20px;
    }
    input, button {
      padding: 8px 12px;
      margin: 10px;
      font-size: 16px;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    #videos {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
    }
    video {
      width: 320px;
      height: 240px;
      background: black;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <h2>ðŸŽ¥ Meeteasy Video Room</h2>

  <input id="roomInput" placeholder="Enter room name" />
  <button id="joinBtn">Join</button>

  <div id="videos">
    <video id="localVideo" autoplay muted playsinline></video>
  </div>

  <script>
    (async () => {
      const localVideo = document.getElementById("localVideo");
      const joinBtn = document.getElementById("joinBtn");
      const roomInput = document.getElementById("roomInput");
      const videos = document.getElementById("videos");

      // Ask for camera and mic access
      let localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
      localVideo.srcObject = localStream;

      // Join button click
      joinBtn.onclick = () => {
        const roomName = roomInput.value.trim();
        if (!roomName) return alert("Enter room name");

        // Connect WebSocket
        const ws = new WebSocket(`ws://${window.location.host}/ws/room/${roomName}/`);

        const peers = {};

        ws.onopen = () => {
          console.log("Connected to room:", roomName);
        };

        ws.onmessage = async (event) => {
          const data = JSON.parse(event.data);
          console.log("Signal:", data);
        };

        ws.onclose = () => {
          console.log("Disconnected from room");
        };
      };
    })();
  </script>
</body>
</html>
